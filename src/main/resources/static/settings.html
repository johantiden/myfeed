<html lang="en" xmlns:javascript="http://www.w3.org/1999/xhtml">
<head>
    <link rel="icon" type="image/png" href="fidn1.png"><!-- Major Browsers -->
    <!--[if IE]><link rel="SHORTCUT ICON" href="fidn1.ico"/><![endif]--><!-- Internet Explorer-->
    <link rel="stylesheet" href="css/app.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <script type="text/javascript" src="./bower_components/angular/angular.js"></script>
    <script type="text/javascript" src="./bower_components/angular-resource/angular-resource.js"></script>
    <script type="text/javascript" src="./bower_components/angular-cookies/angular-cookies.js"></script>
    <script type="text/javascript" src="./bower_components/angular-animate/angular-animate.js"></script>
    <script type="text/javascript" src="./app/app.js"></script>
    <script type="text/javascript" src="./app/controllers.js"></script>
    <script type="text/javascript" src="./app/services.js"></script>
    <title>fidn</title>
</head>
<body>
<div ng-app="myApp" ng-controller="settingsCtrl">
    <div class="navbar">
        <div class="nav-center">
            <a href="/?user={{user}}"><img class="logo-img" src="fidn1.png"></a><br />
        </div>
    </div>

    <div>
        Coming soon: Edit subject rules using regex! Note that this will affect ALL users, so be careful when editing :)
    </div>

    <div style="background-color: WHITE;">
        <h1>Subject Rules</h1>

        <div ng-init="subjectRule = {}">
            <span>Create new:</span>
            <span>Name</span>

            <input type="text"
                   ng-model="subjectRule.name"
                   value="{{subjectRule.name}}">

            <span>Expression</span>
            <input type="text"
                   ng-model="subjectRule.expression"
                   value="{{subjectRule.expression}}">

            <button ng-click="createSubjectRule(subjectRule); subjectRule = {}">Add</button>
        </div>

        <hr />

        <div ng-repeat="subjectRule in subjectRules | orderBy: '[name, expression]'">
            <span style="color: #AAAAAA; width: 50px;">{{subjectRule.id}}</span>
            <span>Name</span>
            <input type="hidden" ng-init="subjectRule.serverSideName = subjectRule.name" ng-model="subjectRule.serverSideName">
            <input type="text"
                   ng-class="{'dirty':subjectRule.name != subjectRule.serverSideName}"
                   ng-model="subjectRule.name"
                   value="{{subjectRule.name}}">

            <span>Expression</span>
            <input type="hidden" ng-init="subjectRule.serverSideExpression = subjectRule.expression" ng-model="subjectRule.serverSideExpression">
            <input type="text"
                   ng-class="{'dirty':subjectRule.expression != subjectRule.serverSideExpression}"
                   ng-model="subjectRule.expression"
                   value="{{subjectRule.expression}}">

            <button
                ng-class="{'dirty':subjectRule.name != subjectRule.serverSideName || subjectRule.expression != subjectRule.serverSideExpression}"
                ng-click="putSubjectRule(subjectRule); subjectRule.serverSideName = subjectRule.name; subjectRule.serverSideExpression = subjectRule.expression">Save</button>
            <button ng-click="deleteSubjectRule(subjectRule)">Delete</button>
        </div>
    </div>

</div>
</body>
</html>
